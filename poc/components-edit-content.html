<!DOCTYPE html><html><head><title>components-add-remove</title>
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<script src="//cdn.tinymce.com/4/tinymce.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="basic.css">
</head><body>

<div id="EditorToolbar"></div>
<button class="btn" onClick="load()">Load</button>
<div id="app">
    <component 
        v-for="comp in comps"
        :is="comp.type"
        :properties="comp.properties">
    </component>
</div>

<script type="text/javascript">

// Components defined by dev
var cTitle = {
    props: ['properties'],
    template: '<h1 :style="properties.css">{{ properties.text }}</h1>'
}
var cHeadingBlock = {
    props: ['properties'],
    template: '<div class="wrapper"><div class="edit-simple"><h1 v-html="properties.titleText"></h1></div><hr><div class="edit-robust" v-html="properties.copyText"></div></div>',
    mounted: initEditing
}

// Dummy data. Pretend it's saved in a db
var savedComponents = [
    {
        type: 'Heading Block',
        properties: {
            titleText: 'Saved Title Text',
            copyText: '<p>This copy text was saved in a database</p>'
        }
    }
]

var app = new Vue({
    el: '#app',
    data: {
        comps: [{type:'Content Title',properties:{text:'Default Title Text'}}]
    },
    // Bind human readable name to component objects
    components: {
        'Content Title': cTitle,
        'Heading Block': cHeadingBlock
    }
})


function load() {
    app.comps = savedComponents;
}

function editorGlobal() {
    return {
        plugins: 'image table link lists paste textpattern autolink',
        toolbar: 'undo redo bold italic alignleft aligncenter link',
        insert_toolbar: false,
        fixed_toolbar_container: '#EditorToolbar',
        menubar: false,
        inline: true
    }
}

function editorSimple(id) {
    var config = editorGlobal();
    config.selector = '#'+id +'.edit-simple, #'+id+' .edit-simple';
    return config;
}

function editorRobust(id) {
    var config = editorGlobal();
    config.selector = '#'+id +'.edit-robust, #'+id+' .edit-robust';
    config.toolbar += ' bullist numlist';
    return config;
}

function initEditing() {
    var $comp = $(this.$el),
        id = genID(12);
    $comp.attr('id', id);
    tinymce.init(editorSimple(id));
    tinymce.init(editorRobust(id));
}


function random(min, max) {
    return Math.floor(Math.random() * (max - min + 1) + min);
}
  
function genID(num) {
    var id = 'ID-', i = 1;
    while (i <= num) {
        if (i % 2 === 0) {
            id += String.fromCharCode(random(65, 90));
        } else {
            id += String.fromCharCode(random(48, 57));
        }
        i++;
    }
    return id;
}


</script></body></html>