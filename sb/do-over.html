<!DOCTYPE html>
<html>
<head>
<title>Do Over</title>
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<link rel="stylesheet" type="text/css" href="doover.css">
<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
</head>
<body>

<div id="App" v-cloak>
    <main id="Stage"></main>
    <aside id="Thumbnails">
        <component v-for="thumb in thumbnails" :is="thumb.name"></component>
    </aside>
</div>

<script src="//cdn.tinymce.com/4/tinymce.min.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/dragula/3.7.2/dragula.min.js'></script>
<script type="text/javascript">

var Stage = $('#Stage')[0],
    Thumbnails = $('#Thumbnails')[0];

var drake = dragula([Stage, Thumbnails], {
    copy: function(el, source) {
        return $(source).attr('id') === 'Thumbnails';
    },
    accepts: function(el, target) {
        return (target === Stage || $(target).hasClass('Environment')) && $(target).parent().attr('id') !== 'Thumbnails';
    }
});

Vue.component('environment', {
    template: '<div class="Environment"></div>',
    mounted: function() {
        dragula([this.$el], {
            accepts: function(el, target) {
                return $(target).hasClass('Environment') && $(target).parent().attr('id') !== 'Thumbnails';
            }
        });
    }
})

var app = new Vue({
    el: '#App',
    data: {
        thumbnails: [{name: 'environment'}],
        stage: []
    },
    methods: {
        sort: function(data) {
            var _data = JSON.parse(JSON.stringify(data));
            var dataSorted = {};
            Object.keys(_data).sort().forEach(function(key) {
                dataSorted[key] = _data[key];
            })
            return dataSorted;
        }
    },
    mounted: function() {
        
    }
})

var Stage = $('#Stage')[0],
    Thumbnails = $('#Thumbnails')[0];

var drake = dragula([Stage, Thumbnails], {
    copy: function(el, source) {
        return $(source).attr('id') === 'Thumbnails';
    },
    accepts: function(el, target) {
        return (target === Stage || $(target).hasClass('Environment')) && $(target).parent().attr('id') !== 'Thumbnails';
    }
});

// UTILITIES

var _ = {};
_.random = function(min, max) {
    return Math.floor(Math.random() * (max - min + 1) + min);
}
_.genID = function(num) {
    var id = 'ID-', i = 1;
    while (i <= num) {
        if (i % 2 === 0) {
            id += String.fromCharCode(_.random(65, 90));
        } else {
            id += String.fromCharCode(_.random(48, 57));
        }
        i++;
    }
    return id;
}
_.copy = function(obj) {
    return JSON.parse(JSON.stringify(obj));
}

</script>
</body>
</html>